import argparse

from dataset_conversion.reader.big_vul_linevul_reader import BigVulLineVulReader
from dataset_conversion.writer.big_vul_linevul_writer import BigVulLineVulWriter
from src.dataset_conversion.reader.big_vul_reader import BigVulReader
from src.dataset_conversion.writer.big_vul_writer import BigVulWriter

readers = {
    'big_vul_linevul': BigVulLineVulReader,
    'big_vul': BigVulReader
}

writers = {
    'big_vul_linevul': BigVulLineVulWriter,
    'big_vul': BigVulWriter
}
if __name__ == "__main__":
    parser = argparse.ArgumentParser(
        prog='dataset-converter',
        description='Convert datasets for static code analyzers')
    parser.add_argument("--input-type", type=str, help="The type of input data", required=True)
    parser.add_argument("--output-type", type=str, help="The type of output data", required=True)
    parser.add_argument("--input-file", type=str, help="The path to the input file", required=True)
    parser.add_argument("--output-file", type=str, help="The path to the output file", required=True)
    args = parser.parse_args()

    # Check type and select corresponding reader/writer
    reader = readers[args.input_type](args.input_file)
    writer = writers[args.output_type](args.output_file, reader)

    writer.write_file()
