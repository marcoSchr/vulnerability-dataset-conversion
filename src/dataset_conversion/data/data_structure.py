from src.dataset_conversion.data.file_change import FileChange


class DataStructure:

    # ?
    index: str = None
    # How access was gained: ['None', 'User', 'Admin']
    access_gained: str = None
    # CVE: Access: Vector?
    attack_origin: str = None
    # CVE: Access: Authentication
    authentication_required: str = None
    # CVE: Impact: Availability
    availability: str = None
    # CVE: ID
    cve_id: str = None
    # Link to cvedetails.com? Maybe add other page?
    cve_page: str = None
    # CVE: CWE
    cwe_id: str = None
    # CVE: Access: Complexity
    complexity: str = None
    # CVE: Impact: Confidentiality
    confidentiality: str = None
    # CVE: Impact: Integrity
    integrity: str = None
    # ?
    known_exploits: str = None
    # CVE: Publish date
    publish_date: str = None
    # CVE: Base Score
    score: str = None
    # CVE: Summary
    summary: str = None
    # CVE: Update Date
    update_date: str = None
    # ?
    vulnerability_classification: str = None
    # added lines in vulnerable function
    add_lines: str = None
    # Link to Vulnerability Fixing Commit
    codeLink: str = None
    # Commit Hash of Vulnerability Fixing Commit
    commit_id: str = None
    # Commit message of Vulnerability Fixing Commit
    commit_message: str = None
    # deleted lines in vulnerable function
    del_lines: str = None
    # file name fur vulnerable function
    file_name: str = None
    # list of changes in commit_id
    files_changed: list[FileChange] = []
    # vulnerable Function after Fix
    func_after: str = None
    # vulnerable Function before fix
    func_before: str = None
    # Programming Language used e.g.: C
    lang: str = None
    # vulnerable lines after fix
    lines_after: str = None
    # vulnerable lines before fix
    lines_before: str = None
    # ?
    parentID: str = None
    # Patch for commit ID
    patch: str = None
    # Project Name for Commit
    project: str = None
    # Commit ID
    project_after: str = None
    # Parent commit ID
    project_before: str = None
    # Label: 0 -> not vulnerable, 1 -> vulnerable?
    target: str = None
    # Similar to func_after has //flaw_line_below: comment above and //fix_flaw_line_below: 
    # around vulnerable line and commented fixed line below
    vul_func_with_fix: str = None
    # function_before without additional whitespace?
    processed_func: str = None
    # list of vulnerable lines
    flaw_line: list[str] = []
    # list of line index of flaw line (line number - 1)
    flaw_line_index: list[int] = []

    # TODO: add all possible inputs as named input, initialized to None
    # This will allow adding more input in the future, as other implementations will then just use None,
    # as they do not have the corresponding fields
    # Readers and writers can then use the data they need and ignore the rest
    # But they need to be able to handle fields that are None
    # VulChecker for example has only raw source code and exact line numbers as positive data source
    # --> How to convert a single file with line numbers to commit diffs?
    def __init__(self, index: str = None,
                 access_gained: str = None,
                 attack_origin: str = None,
                 authentication_required: str = None,
                 availability: str = None,
                 cve_id: str = None,
                 cve_page: str = None,
                 cwe_id: str = None,
                 complexity: str = None,
                 confidentiality: str = None,
                 integrity: str = None,
                 known_exploits: str = None,
                 publish_date: str = None,
                 score: str = None,
                 summary: str = None,
                 update_date: str = None,
                 vulnerability_classification: str = None,
                 add_lines: str = None,
                 codeLink: str = None,
                 commit_id: str = None,
                 commit_message: str = None,
                 del_lines: str = None,
                 file_name: str = None,
                 files_changed: list[FileChange] = [],
                 func_after: str = None,
                 func_before: str = None,
                 lang: str = None,
                 lines_after: str = None,
                 lines_before: str = None,
                 parentID: str = None,
                 patch: str = None,
                 project: str = None,
                 project_after: str = None,
                 project_before: str = None,
                 target: str = None,
                 vul_func_with_fix: str = None,
                 processed_func: str = None,
                 flaw_line: list[str] = [],
                 flaw_line_index: list[int] = []):
        self.index = index
        self.access_gained = access_gained
        self.attack_origin = attack_origin
        self.authentication_required = authentication_required
        self.availability = availability
        self.cve_id = cve_id
        self.cve_page = cve_page
        self.cwe_id = cwe_id
        self.complexity = complexity
        self.confidentiality = confidentiality
        self.integrity = integrity
        self.known_exploits = known_exploits
        self.publish_date = publish_date
        self.score = score
        self.summary = summary
        self.update_date = update_date
        self.vulnerability_classification = vulnerability_classification
        self.add_lines = add_lines
        self.codeLink = codeLink
        self.commit_id = commit_id
        self.commit_message = commit_message
        self.del_lines = del_lines
        self.file_name = file_name
        self.files_changed = files_changed
        self.func_after = func_after
        self.func_before = func_before
        self.lang = lang
        self.lines_after = lines_after
        self.lines_before = lines_before
        self.parentID = parentID
        self.patch = patch
        self.project = project
        self.project_after = project_after
        self.project_before = project_before
        self.target = target
        self.vul_func_with_fix = vul_func_with_fix
        self.processed_func = processed_func
        self.flaw_line = flaw_line
        self.flaw_line_index = flaw_line_index
