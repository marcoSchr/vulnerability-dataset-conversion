import pandas

from .writer import Writer
from ..data_structure import DataStructure


HEADER = []


class BigVulWriter(Writer):
    def write_file(self):
        with open(self.file_path, 'w') as output_file:
            for n, element in enumerate(self.reader.read_file()):
                field = self.convert_to_big_vul(element)
                if n == 0:
                    field.to_csv(output_file, header=HEADER, index=False)
                else:
                    field.to_csv(output_file, header=False, index=False)

    def convert_to_big_vul(self, field: DataStructure) -> pandas.DataFrame:
        return pandas.DataFrame()

