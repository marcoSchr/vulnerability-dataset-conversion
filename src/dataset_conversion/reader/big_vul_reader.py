import pandas

from .reader import Reader
from ..data_structure import DataStructure


class BigVulReader(Reader):
    def read_file(self):
        for chunk in pandas.read_csv(self.file_path, chunksize=128):
            for field in chunk.iterrows():
                yield self.convert_to_data_structure(field)

    def convert_to_data_structure(self, field) -> DataStructure:
        d = DataStructure()
        # TODO: actual implementation
        return d
